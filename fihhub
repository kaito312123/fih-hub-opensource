-- [[ LIBRARY LOADING ]] --
local HttpRequest = request or http_request or http and http.request or syn and syn.request
local ModuleData = HttpRequest({Method = "GET", Url = "https://raw.githubusercontent.com/KadeTheExploiter/Machina/refs/heads/main/Module.luau"})
local GuiLibrary = loadstring(ModuleData.Body)()

-- [[ CONFIGURATIONS ]] --
local NOME_DA_PART = "WINPART"
local ALTURA_OFFSET = 7
local INTERVALO = 1
local tpLigado = false
local afkLigado = false

-- [[ SIGMA HUB INTERFACE ]] --
local MainFrame, ScreenGui = GuiLibrary:Load("Sigma Hub", "Dark")

local Tabs = {
    Main = MainFrame:NewTabEntry("Main", "rbxassetid://10734945662"),
    Scripts = MainFrame:NewTabEntry("Utilities", "rbxassetid://10734944532")
}

-- [[ CLEANUP FUNCTION ]] --
local function cleanMap()
    local count = 0
    for _, obj in pairs(game.Workspace:GetDescendants()) do
        if obj:IsA("BasePart") and (obj.Name == "KillBrick" or obj.Name == "Invis") then
            obj:Destroy()
            count = count + 1
        end
    end
    game:GetService("StarterGui"):SetCore("SendNotification", {
        Title = "Map Cleaned",
        Text = "Removed " .. count .. " dangerous objects.",
        Duration = 3
    })
end

-- [[ TELEPORT LOGIC WITH JUMP ]] --
task.spawn(function()
    while true do
        if tpLigado then
            pcall(function()
                local target = nil
                for _, obj in pairs(game.Workspace:GetDescendants()) do
                    if obj.Name == NOME_DA_PART and obj:IsA("BasePart") then
                        target = obj
                        break
                    end
                end

                if target then
                    local char = game.Players.LocalPlayer.Character
                    local root = char and char:FindFirstChild("HumanoidRootPart")
                    local hum = char and char:FindFirstChildOfClass("Humanoid")
                    
                    if root and hum then
                        -- Jump logic to trigger part movement detection
                        hum.Jump = true
                        task.wait(0.1) 
                        
                        root.CFrame = target.CFrame * CFrame.new(0, ALTURA_OFFSET, 0)
                        root.Velocity = Vector3.new(0, 0, 0)
                    end
                end
            end)
        end
        task.wait(INTERVALO)
    end
end)

-- [[ UI ELEMENTS ]] --

-- TP Toggle
Tabs.Main:NewToggleEntry("Auto Farm (WinPart)", "Jump & TP to WinPart", false, function(state)
    tpLigado = state
end)

-- Anti-AFK Toggle
Tabs.Main:NewToggleEntry("Anti-AFK", "Prevent disconnect for inactivity", false, function(state)
    afkLigado = state
end)

-- Cleanup Button
Tabs.Scripts:NewButtonEntry("Destroy KillBricks/Invis", "Removes objects from the image", function()
    cleanMap()
end)

-- [[ ANTI-AFK LOGIC ]] --
game.Players.LocalPlayer.Idled:Connect(function()
    if afkLigado then
        game:GetService("VirtualUser"):CaptureController()
        game:GetService("VirtualUser"):ClickButton2(Vector2.new())
    end
end)

print("Sigma Hub loaded successfully")
