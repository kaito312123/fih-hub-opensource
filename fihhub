local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

_G.noclip = false
_G.flyEnabled = false
_G.antiAfk = false
_G.autoFarm = false
_G.flySpeed = 50

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local VirtualUser = game:GetService("VirtualUser")
local LocalPlayer = Players.LocalPlayer

local Window = Rayfield:CreateWindow({
   Name = "FihHub",
   LoadingTitle = "FihHub",
   LoadingSubtitle = "by Slick1245",
   ConfigurationSaving = { Enabled = true, FolderName = "FihHubConfigs", FileName = "settings" },
   KeySystem = false 
})

local MainTab = Window:CreateTab("Main", 4483345998)
local MovementTab = Window:CreateTab("Movement", 4483345998)
local SettingsTab = Window:CreateTab("Settings", 4483345998)
local CreditsTab = Window:CreateTab("Credits", 4483345998)

-- PRIMEIRA ABA (MAIN)
MainTab:CreateSection("Farm")

MainTab:CreateToggle({
   Name = "Auto Farm",
   CurrentValue = false,
   Callback = function(Value) 
      _G.autoFarm = Value 
   end,
})

MainTab:CreateSection("Security")

MainTab:CreateToggle({
   Name = "Anti AFK",
   CurrentValue = false,
   Callback = function(Value) _G.antiAfk = Value end,
})

-- SEGUNDA ABA (MOVEMENT)
MovementTab:CreateSection("Fly")

local FlyToggle = MovementTab:CreateToggle({
   Name = "Fly F",
   CurrentValue = false,
   Callback = function(Value) _G.flyEnabled = Value end,
})

MovementTab:CreateSlider({
   Name = "Speed",
   Range = {10, 500},
   Increment = 10,
   CurrentValue = 50,
   Callback = function(Value) _G.flySpeed = Value end,
})

MovementTab:CreateSection("Noclip")

local NoclipToggle = MovementTab:CreateToggle({
   Name = "Noclip N",
   CurrentValue = false,
   Callback = function(Value) _G.noclip = Value end,
})

-- OUTRAS ABAS
SettingsTab:CreateSection("Menu")
SettingsTab:CreateLabel("Alt para fechar")

CreditsTab:CreateSection("Owner")
CreditsTab:CreateLabel("Slick1245")

-- LOGICA AUTO FARM
spawn(function()
    while task.wait() do
        if _G.autoFarm then
            pcall(function()
                for _, v in pairs(workspace:GetDescendants()) do
                    if v:IsA("TouchTransmitter") and _G.autoFarm then
                        LocalPlayer.Character.HumanoidRootPart.CFrame = v.Parent.CFrame
                        task.wait(0.1)
                    end
                end
            end)
        end
    end
end)

-- LOGICA FLY (CAI SEM RAGDOLL)
RunService.RenderStepped:Connect(function()
    if _G.flyEnabled and LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
        local root = LocalPlayer.Character.HumanoidRootPart
        local cam = workspace.CurrentCamera
        local bv = root:FindFirstChild("FlyBV") or Instance.new("BodyVelocity", root)
        bv.Name = "FlyBV"
        bv.MaxForce = Vector3.new(math.huge, math.huge, math.huge)
        local bg = root:FindFirstChild("FlyBG") or Instance.new("BodyGyro", root)
        bg.Name = "FlyBG"
        bg.MaxTorque = Vector3.new(math.huge, math.huge, math.huge)
        
        local moveDir = Vector3.new(0,0,0)
        if UserInputService:IsKeyDown(Enum.KeyCode.W) then moveDir = moveDir + cam.CFrame.LookVector end
        if UserInputService:IsKeyDown(Enum.KeyCode.S) then moveDir = moveDir - cam.CFrame.LookVector end
        if UserInputService:IsKeyDown(Enum.KeyCode.A) then moveDir = moveDir - cam.CFrame.RightVector end
        if UserInputService:IsKeyDown(Enum.KeyCode.D) then moveDir = moveDir + cam.CFrame.RightVector end
        bv.Velocity = moveDir * _G.flySpeed
        bg.CFrame = cam.CFrame
    else
        if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
            local root = LocalPlayer.Character.HumanoidRootPart
            if root:FindFirstChild("FlyBV") then root.FlyBV:Destroy() end
            if root:FindFirstChild("FlyBG") then root.FlyBG:Destroy() end
        end
    end
end)

-- LOGICA NOCLIP
RunService.Stepped:Connect(function()
    if LocalPlayer.Character and _G.noclip then
        for _, part in pairs(LocalPlayer.Character:GetDescendants()) do
            if part:IsA("BasePart") then part.CanCollide = false end
        end
    end
end)

-- ANTI AFK
LocalPlayer.Idled:Connect(function()
    if _G.antiAfk then
        VirtualUser:CaptureController()
        VirtualUser:ClickButton2(Vector2.new())
    end
end)

-- TECLAS FIXAS (TOGGLE REAL)
UserInputService.InputBegan:Connect(function(input, gpe)
    if gpe then return end
    if input.KeyCode == Enum.KeyCode.F then
        FlyToggle:Set(not _G.flyEnabled)
    end
    if input.KeyCode == Enum.KeyCode.N then
        NoclipToggle:Set(not _G.noclip)
    end
    if input.KeyCode == Enum.KeyCode.LeftAlt then
        local gui = game:GetService("CoreGui"):FindFirstChild("Rayfield") or LocalPlayer:WaitForChild("PlayerGui"):FindFirstChild("Rayfield")
        if gui then gui.Enabled = not gui.Enabled end
    end
end)

Rayfield:LoadConfiguration()
